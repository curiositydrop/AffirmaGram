<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Render Test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>body{font-family:system-ui;padding:16px;background:#0b0b0b;color:#eaeaea} textarea,button{width:100%;padding:10px;border-radius:8px;border:1px solid #333;background:#141414;color:#eaeaea} img{max-width:100%;height:auto;display:block;margin-top:8px}</style>
</head>
<body>
  <h1>Test Render</h1>
  <textarea id="p" rows="4">minimal geometric monogram of RR, flat vector, no gradients</textarea>
  <button id="go">Go</button>
  <pre id="out"></pre>
  <div id="imgs"></div>

  <script>
    document.getElementById('go').onclick = async () => {
      const prompt = document.getElementById('p').value.trim();
      const out = document.getElementById('out');
      const imgs = document.getElementById('imgs');
      out.textContent = 'Calling functionâ€¦';
      imgs.innerHTML = '';
      try {
        const res = await fetch('/.netlify/functions/render', {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ prompt, size: "1024x1024", n: 2 })
        });
        const raw = await res.text();
        out.textContent = raw.slice(0, 1200);
        let data; try { data = JSON.parse(raw); } catch { data = null; }
        (data?.pngs || []).forEach(src => {
          const img = new Image();
          img.src = src;
          imgs.appendChild(img);
        });
      } catch (e) {
        out.textContent = 'Fetch failed: ' + String(e);
      }
    };
  </script>
</body>
</html>
